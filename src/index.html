<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="sass/index.css"/>
		<link rel="stylesheet" type="text/css" href="sass/swiper.css"/>
	</head>
	<body>
		<!--头部-->
		<header>
			<p class="city">
				<span>北京</span>
				<a href="#" id="city-btn">[切换城市]</a>
				<a href="#">同城帮首页</a>
			</p>
			<div id="citypage1">
				<h5>城市列表</h5>
				<div id="citypage">
					<h6>热门城市：</h6>
					<ul id="hot-list">		
					</ul>
					<h6>拼音:</h6>
					<ul id="letter-list">
					</ul>
					<ul id="city-list">
					</ul>
				</div>
					
			</div>
			<ul class="log">
				<li><a href="#" class="lg1">登录<span>|</span></a></li>
				<li><a href="#" class="lg">注册<span>|</span></a></li>
				<li><a href="#">我的订单<span>|</span></a></li>
				<li><a href="#">在线客服（9：00-21：00）<span>|</span></a></li>
				<li><a href="#">客户服务<span>|</span></a></li>
				<li><a href="#">论坛<span>|</span></a></li>
				<li><a href="#" class="advise">投诉建议</a></li>
			</ul>
			<!--登录-->
			<div id="login">
				<span id="close-lg">x</span>
				<h2>欢迎注册360同城帮</h2>
				<p>账号：<input type="text"  id="userName"/></p>
				<p>密码：<input type="text" id="pwd" /></p>
				<input type="checkbox" />下次自动登录
				<button id="lgBtn" onclick="logIn()">立即登录</button><br />
				<span>其他账号登录</span><img src="image/dianxin.png"/><img src="image/feixin.png"/>
			</div>
			<!--注册-->
			<div id="newUser">
				<span id="close-log">x</span>
				<h2>欢迎注册360同城帮</h2>
				<div id="user-block">
					<h3 class="tel"><img src="image/phone.png"/>手机号注册</h3>
					<h3 class="emile"><img src="image/mail.png"/>邮箱注册</h3>
					<p>已有账号，<a href="#">立即登录</a></p>
				</div>
				<div id="tel-block">
					<!--需要接口，验证手机是否注册-->
				手机号<input type="text"  id="tel"/><span>请输入您的手机号</span><br />
				<!--需要接口，返回校验码-->
				验证码<input type="text" id="yzm" /><b id="yz"></b><a href="#" onclick = "getYzm()">换一张</a><span>请输入图中的字母或数字，不区分大小写</span><br />
				<!--需要接口，发送验证码-->
				校验码<input type="text" id="jym"/><button onclick="clickXy()">免费获取校验码</button><span>请输入短信中6位数字校验码</span><br />
				<!--前台验证-->
				密&nbsp;&nbsp;&nbsp;码<input type="text" id="pwd" /><span>6-20个字符(区分大小写)</span><br />
				<button onclick="addUser()" id="set">马上注册</button><br />
				<!--需要接口 添加用户-->
				<input type="checkbox" id="check"/>我已阅读并同意<a href="#">360服务条款</a>
				</div>
				
			</div>
		</header>
		<!--导航-->
		<nav>
			<ul>
				<li><a href="#">二手优品</a></li>
				<li><a href="#">手机回收</a></li>
				<li><a href="#">手机维修</a></li>
				<li><a href="#">电脑维修</a></li>
				<li><a href="#">以旧换新</a></li>
				<li><a href="#">手机租用</a></li>
			</ul>
		</nav>
		<!--轮播图-->
		<div class="swiper-container ">
			  <div class="swiper-wrapper">
			    <div class="swiper-slide"><img src="image/roll0.jpg"/></div>
			    <div class="swiper-slide"><img src="image/roll1.jpg"/></div>
			   	<div class="swiper-slide"><img src="image/roll2.jpg"/></div>
			   	<div class="swiper-slide"><img src="image/roll3.jpg"/></div>
	 		 </div>
	 		 <div class="swiper-pagination"></div>
	 		 <div class="banner-list">
	 		 	<ul>
	 		 		<li><span>修手机/Pad</span><a href="#">&gt;</a></li>
	 		 		<li><span>修电脑</span><a href="#">&gt;</a></li>
	 		 		<li><span>卖手机/电脑</span><a href="#">&gt;</a></li>
	 		 		<li><span>卖二手手机</span><a href="#">&gt;</a></li>
	 		 	</ul>
	 		 </div>
		</div>
		<!--中间模块的内容-->
		<div class="content">
			<!--第一行的图片裂变-->
			<div class="pic-list">
				<img src="image/ad0.jpg" alt="" />
				<img src="image/ad1.jpg" alt="" />
				<img src="image/ad2.png" alt="" />
				<img src="image/ad3.jpg" alt="" />
			</div>
			<!--热门手机回收-->
			<h2>热门手机回收 <a href="#">查看更多</a></h2>
			<div class="hot-tel">
				<div class="pic-head">
					<img src="image/ad0.png"/>
				</div>
				<ul id ="phone">
					
				</ul>
				
			</div>
			<h2>优品精选<a href="#">查看更多</a></h2>
			<div class="hot-select">
				<div class="pic-select">
					<img src="image/ad1.png"/>
				</div>
				<ul id="like">
					
				</ul>
			</div>
			<h2 >到店维修</h2>
		
		</div>
		
		<p class="select">
			<span>北京</span>
			<span>选择区县</span>
			<input type="text"  /><input type="button" name="" id="" value="搜索"/ >
		</p>
		<!--内容底部的店铺列表-->
		<div class="shop-list">
			<div class="bar">
				<ul>
					<li id="default">默认排序</li>
					<li id="number">按成交量</li>
					<li id="people">按人气</li>	
				</ul>
				<span style="border: none;"><input type="checkbox" name="" id="" value=""  />先行赔付</span>
				<a href="javascript:return false" id="map-btn">地图模式</a>
			<div id="map-box">
				<input type="text" id="search" />
				<div id="container" style="width:800px; height:500px"></div>
			</div>
			</div>
			
			<!--店铺盒子-->
			<div class="shop">
				<!--<dl>
					<dt><img src="image/goods3.jpg"/></dt>
					<dd>
						<p><a href="#">顺通电脑维修</a><span>店铺等级：</span></p><span>先行赔付</span><br />
						<p>主营：电脑维修，电脑周边配件，系统维护，网络安全，打印...</p><span>同城帮认证</span><br />
						<p>地址：北京市通州区瑞都大厦3030...</p><span>人气1234567次浏览</span><br />
					</dd>
					<span class="in-shop">进入店铺</span>
				</dl>-->
					
				
			</div>
	</div>
	<p id="good">商家好评榜</p>
		<div class="like">
			
			
			<!--<dl>
				<dt><span>1</span><img src="image/goods3.jpg" alt="" /></dt>
				<dd>附加费接口规范开关柜</dd>
				<dd>发几个发给大家分开</dd>
			</dl>
			<dl>
				<dt><span>1</span><img src="image/goods3.jpg" alt="" /></dt>
				<dd>附加费接口规范开关柜</dd>
				<dd>发几个发给大家分开</dd>
			</dl>-->
		</div>
		<div class="footer">
			<ul>
				<li>
					<h3><img src="image/feixin.png"/>购物指南</h3>
					<a href="#">购物流程</a></br>
					<a href="#">帮助文档</a>
				</li>
			</ul>
			<ul>
				<li>
					<h3><img src="image/feixin.png"/>购物指南</h3>
					<a href="#">购物流程</a></br>
					<a href="#">帮助文档</a>
				</li>
			</ul>
			<ul>
				<li>
					<h3><img src="image/feixin.png"/>购物指南</h3>
					<a href="#">购物流程</a></br>
					<a href="#">帮助文档</a>
				</li>
			</ul>
			<ul>
				<li>
					<h3><img src="image/feixin.png"/>购物指南</h3>
					<a href="#">购物流程</a></br>
					<a href="#">帮助文档</a>
				</li>
			</ul>
			<ul>
				<li>
					<h3><img src="image/feixin.png"/>购物指南</h3>
					<a href="#">购物流程</a></br>
					<a href="#">帮助文档</a>
				</li>
			</ul>
			<p>		
			<span>客服电话：4000-399-360 / 010-53767360 </span><a href="#">投诉建议</a> <a href="#">网站地图</a>
			</p>
			<p>Copyright © 2005-2017  360.CN  All Rights Reserved <span>360安全中心</span> </p>
<p><span>京ICP备08010314号-19 </span><span> 京公网安备110000000006号</span></p>
		</div>
	</body>
	
</html>
<script type="text/html" id="city-tmp">

	<%for(var i = 0;i<arr.length;i++){%>
		<li>
			<%=arr[i].name%>
		</li>	
	<%}%>
</script>
<script type="text/html" id="letter-tmp">
	
	<%for(var i in letterObj){%>
		<li onclick="tab('<%=i%>')"><%=i%></li>
	<%}%>
</script>
<script type="text/template" id="city-tmp">
	
</script>
<script type="text/html" id="tel-list">
	
	<%for(var i = 0;i < arr.length;i++){%>
		<li>
			<img src="<%=arr[i].img_url%>"/>
			<p><%=arr[i].model_alis%></p>
		</li>	
	<%}%>
</script>
<script type="text/html" id="old-list">
	<%for(var i = 0;i < arr.length;i++){%>
		<li>
			<img src="<%=arr[i].thum_img.big%>"/>
			<p><%=arr[i].brand_name%><%=arr[i].model_name%><br><%=arr[i].price%></p>
		</li>	
	<%}%>
</script>
<script type="text/html" id="store-tmp">
	
	<%for(var i = 0 ; i < arr.length ; i ++){%>
		<dl>
			<dt><img src="<%=arr[i].shop_ico%>"/></dt>
			<dd>
				<p><a href="#"><%=arr[i].shop_name%></a><span>店铺等级：<%=arr[i].level%></span></p><span>先行赔付</span><br />
				<p>主营：<%=arr[i].main%></p><span>同城帮认证</span><br />
				<p>地址：<%=arr[i].addr_detail%></p><span>人气1234567次浏览</span><br />
			</dd>
				<span class="in-shop">进入店铺</span>
		</dl>
	<%}%>
</script>
<script type="text/html" id="hot-list-tmp">
	<%for(var i = 0 ; i < arr.length ; i ++){%>
	<dl>
		<dt><span>1</span><img src="<%=arr[i].shop_ico%>" alt="" /></dt>
		<dd><a href="#"><%=arr[i].shop_name%></a></dd>
		<dd><%=arr[i].shop_visit%></dd>
	</dl>
	<%}%>
</script>
<script type="text/javascript" src="http://webapi.amap.com/maps?v=1.4.0&key=1118c35f02f4a0945dbeab07edecdc79"></script> 
<script src="js/baiduTemplate.js" type="text/javascript" charset="utf-8"></script>
<script src="js/swiper.js" type="text/javascript" charset="utf-8"></script>
<script src="js/jquery1.11.1.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
	//店铺排序
	function getAllStore(type){
		$.get("http://localhost:6500/px",{
    		type:type
	    },function(res){
	    	console.log(res);
	    	var obj = {};
	    	obj.arr = res;
	    	$(".shop").html(baidu.template("store-tmp",obj))
	    	enterStore()
	    })
	}
    //点击店铺按钮进入店铺
    function enterStore(){
    	$.each($(".in-shop"),function(index,item){
    		$(item).on("click",function(){
    			open("html/shop.html")
    		})
    	})
    }
   //默认排序
    getAllStore("")
      $("#default").click(function(){
      	$(this).css({
      		color:"green",
      		background:"#ffffff"
      	}).nextAll().css({
      		background:"#eee"
      	})
      	getAllStore("")
      })
      //按数量排序
	 $("#number").click(function(){
      	$(this).css({
      		color:"green",
      		background:"#ffffff"
      	}).next().css({
      		background:"#eee"
      	}).prev().prev().css({
      		background:"#eee"
      	})
      		getAllStore("count")
      })
	 //按人气排序
	  $("#people").click(function(){
      	$(this).css({
      		color:"green",
      		background:"#ffffff"
      	}).prev().css({
      		background:"#eee"
      	}).prev().css({
      		background:"#eee"
      	})
      		getAllStore("shop_visit")
      })
	  
	  ///////////////////////////////////////////////////////////////////////////////
	
	//获取图片
	function getPhone(){
		$.get("http://localhost:6500/src/data/shoujihuishou.json",{},function(res){
//			console.log(res)
			var obj = {}
			obj.arr = res.result;
			$("#phone").html(baidu.template("tel-list",obj));
		})
	}
	getPhone()
	//获取优品精选的图片
	function getLike(){
		$.get("http://localhost:6500/src/data/youpinjingxuan.json",{},function(res){
			console.log(res)
			var obj = {}
			obj.arr = res.result;
			$("#like").html(baidu.template("old-list",obj));
		})
	}
	getLike();
	//获取商家好评榜图片
	function getHotStore(){
		$.get("http://localhost:6500/src/data/shops.json",{},function(res){
			console.log(res)
			var obj = {}
//			obj.arr = res.shop_data;
			obj.arr = res.shop_data.slice(0,7);
			$(".like").html(baidu.template("hot-list-tmp",obj));
		})
	}
	getHotStore()
	 ///////////////////////////////////////////////////////////////////////////////
	//轮播图
	var mySwiper = new Swiper('.swiper-container', {
		autoplay: 5000,//可选选项，自动滑动
		pagination : '.swiper-pagination',
	})
	var obj = {} ;
	$("#city-btn").click(function(){
		$("#citypage1").toggle();
	})
	//获取所有信息
	$.get("http://localhost:6500/src/data/city.json",{},function(res){
//		console.log(res);
		obj.arr = res.result.hotcity;
		obj.letterObj = res.result.citylist;
		$("#hot-list").html(baidu.template("city-tmp",obj));
		$("#letter-list").html(baidu.template("letter-tmp",obj));
		tab("A")
	})
	function tab(k){
		var arr = obj.letterObj[k];
		var cityObj = {};
		cityObj.arr = arr;
		$("#city-list").html(baidu.template("city-tmp",cityObj));
	}
	function cgName(name){
		$("h6").html(name)
	}
	/////////////////////////////////////////////////////////////////
	//点击注册
	$(".lg").click(function(){
		$("#newUser").show();
	})
	//点击关闭登录界面
   $("#close-log").click(function(){
// 		$("#newUser").style
		newUser.style.display = "none"
   })
	//首先在输入手机号的框 验证失焦状态手机是否验证过
	$("#tel").on("blur",function(){
		if($("#tel").val()==""){
			$("#tel").next().html("请输入手机号码");
			return;
		}
		$.get("http://localhost:6500/isrepeat",{
			tel:$("#tel").val()
		},function(res){
			console.log(1)
			if(res == 0){
				$("#tel").next().html("该号已被注册，请登录");
			}else{
				$("#tel").next().html("手机号输入正确");
			}
		})
	})
	
	//获取验证码
	function getYzm(){
		$.post("http://localhost:6500/yzm",{},function(res){
//			console.log(res);
			$("#yz").html(res);
		})
	}
	getYzm();
	//获取校验码
	function getXym(){
		$.post("http://localhost:6500/xym",{
			tel:$("#tel").val(),
			time:(new Date()).getTime()
		},function(res){
			console.log(res)
			$("#jym").val(res);
		})
	}
   //点击获取校验码
   function clickXy(){
   	  if($("#tel").val()==""){
   	  	$("#tel").next().html("不能为空");
   	  	return;
   	  }else if($("#yzm").val()==""){
   	  	$("#yz").html("验证码不相符")
   	  }else{
   	  	getXym()
   	  	
   	  }
   }
   //注册
   function addUser(){
   		$.post("http://localhost:6500/addUser",{
   			tel:$("#tel").val(),
   			pwd:$("#pwd").val(),
   			time:(new Date()).getTime(),
   			xym:$("#jym").val()
   		},function(res){
   			console.log(res)
   		})
   }
   //点击复选框 同意条例
   $("#check").click(function(){
   		//如果复选框没有被选中 注册也无法选中
   		if($(this).prop("checked")==false){
   			$("#set").attr("disabled","disabled");
   		}else if($(this).prop("checked")==true){
   			$("#set").removeAttr("disabled");
   		}
   		
   		
   })
   /////////////////////////////////////////////////////////////////////////
   //登录页面
   function logIn(){
   		$.post("http://localhost:6500/login",{
   			tel:$("#tel").val(),
   			pwd:$("#pwd").val(),
   			time:(new Date()).getTime()
   			
   		},function(res){
   			console.log(res)
   			
   		})
   } 
   
   $("#close-lg").click(function(){
   		$("#login").hide()
   })
   $(".lg1").click(function(){
   		$("#login").show()
   })
    ///////////////////////////////////////////////////////////////////////////////
   
   //点击出现地图
   $("#map-btn").click(function(){
   	 $("#map-box").toggle();
   })
   
   
   var map = new AMap.Map('container',{
	   zoom: 10,
	   center: [116.39,39.9]
	});
//添加地图控件

	AMap.plugin(['AMap.ToolBar','AMap.Scale','AMap.OverView'],
	    function(){
	    	//创建工具条对象
	        map.addControl(new AMap.ToolBar());
			//添加到地图上
	        map.addControl(new AMap.Scale());
	
	        map.addControl(new AMap.OverView({isOpen:true}));
	});
	//添加标记
	marker = new AMap.Marker({
		//标记位置 经度和纬度
		position: [116.656552,39.886672],
		//鼠标悬停
		title: "顺通电脑维修",
		icon:"image/icon.png",
		//content:"<div class='st'>顺通电脑</div>",//icon 会被content覆盖
		map: map
	    });
    //向地图添加时间
    var clickFn= function(){
    	alert(1)
    }
    AMap.event.addListener(marker,"click",clickFn);
    //自动补全
    AMap.plugin('AMap.Autocomplete',function(){//回调函数
    //实例化Autocomplete
    var autoOptions = {
        city: "", //城市，默认全国
        input:"search"//使用联想输入的input的id
    };
    autocomplete= new AMap.Autocomplete(autoOptions);
    //TODO: 使用autocomplete对象调用相关功能
		     AMap.event.addListener(autocomplete,"select",function(e){
		     	console.log(e)
		     	e.poi.location;
		     	marker = new AMap.Marker({
				map: map
		    });
	     })
    
	})
    
    AMap.service('AMap.Geocoder',function(){//回调函数
    //实例化Geocoder
	    geocoder = new AMap.Geocoder({
	        city: "010"//城市，默认：“全国”
	    });
    //逆地理编码
		var lnglatXY=[116.396574, 39.992706];//地图上所标点的坐标
		geocoder.getAddress(lnglatXY, function(status, result) {
		    if (status === 'complete' && result.info === 'OK') {
		       //获得了有效的地址信息:
		       //即，result.regeocode.formattedAddress
		    }else{
		       //获取地址失败
		    }
		});  
	    //TODO: 使用geocoder 对象完成相关功能
	})
    
      
</script>
